**INSPECTAIR**

Testspezifikation v2.0

DHBW Ravensburg \| Mikrocomputertechnik 1 \| Team: Maxi, Jannis, Cedric

Version 2.0 - Januar 2026

Ãœbersicht

Diese Testspezifikation enthÃ¤lt **17 TestfÃ¤lle**, die alle Features des
InspectAir-Systems abdecken.

  ------------------------------ ------------ --------------- -----------------
  **Kategorie**                  **Anzahl**   **Bestanden**   **Aufwand**

  Einzeltests Sensoren           6            6 âœ“             erledigt

                                 2            1 ğŸ”„            \~30 Min

                                 1            1 ğŸ”„            \~15 Min

  UI-Tests (2 UIs, Button,       4            0               \~45 Min
  Konsistenz)                                                 

  Power Management (Dimming,     3            0               \~30 Min
  Sleep)                                                      

  Systemtest                     1            0               \~30 Min

  **GESAMT**                     **17**       **6/17**        **\~2.5 Stunden**
  ------------------------------ ------------ --------------- -----------------

Getestete Features

  ----------------------------------- -----------------------------------
  **Feature**                         **Relevante Tests**

  **BS170 MOSFET Backlight-Dimming**  TC-07, TC-14, TC-15

  **StÃ¼tzkondensatoren (220ÂµF         TC-08, TC-09
  (25V))**                            

  **2 verschiedene UIs (Clean +       TC-10, TC-11, TC-12, TC-13
  Detailed)**                         

  **Radar â†’ Display aufwecken**       TC-15, TC-16, TC-17

  **Display dimmen nach Timeout**     TC-14, TC-17

  **ESP32 Light Sleep Modus**         TC-16
  ----------------------------------- -----------------------------------

Teil 1: Einzeltests Sensoren (bestanden)

Diese Tests wurden bereits bei der Komponentenbeschaffung durchgefÃ¼hrt.

  -------------------- -------------------------------------------------------
  **TC-01**            **Einzeltest: Display ST7796S âœ“**

  **Beschreibung**     SPI-Kommunikation und Farbdarstellung des
                       4-Zoll-Displays.

  **Vorbedingung**     Display verkabelt: CSâ†’GPIO14, DCâ†’GPIO13, MOSIâ†’GPIO11,
                       CLKâ†’GPIO12, RSTâ†’GPIO10.

  **Testschritte**     1\. Testfirmware flashen 2. RGB-Vollbildfarben prÃ¼fen
                       (Rot, GrÃ¼n, Blau) 3. Text-Rendering testen

  **Pass-Kriterium**   Display zeigt alle Farben ohne Artefakte. Text scharf
                       lesbar.

  **Ergebnis**         â˜‘ PASS â˜ FAIL Datum: Jan 2026 Tester: Team
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
  **TC-02**            **Einzeltest: AHT20 (Temp/Feuchte) âœ“**

  **Beschreibung**     I2C-Kommunikation und plausible Messwerte.

  **Vorbedingung**     AHT20 an I2C: SDAâ†’GPIO8, SCLâ†’GPIO9. Pull-ups 4.7kÎ©.

  **Testschritte**     1\. I2C-Scan (Adresse 0x38) 2. Temperatur und Feuchte
                       auslesen

  **Pass-Kriterium**   Werte: 15-30Â°C, 30-70% rH.

  **Ergebnis**         â˜‘ PASS â˜ FAIL Datum: Jan 2026 Tester: Team
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
  **TC-03**            **Einzeltest: SGP40 (VOC) âœ“**

  **Beschreibung**     I2C-Kommunikation und VOC-Rohwerte.

  **Vorbedingung**     SGP40 an I2C parallel zu AHT20. Adresse 0x59.

  **Testschritte**     1\. I2C-Scan (Adresse 0x59) 2. SRAW-Wert nach 60s
                       AufwÃ¤rmzeit lesen

  **Pass-Kriterium**   SRAW: 15000-35000. Selbsttest OK.

  **Ergebnis**         â˜‘ PASS â˜ FAIL Datum: Jan 2026 Tester: Team
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
  **TC-04**            **Einzeltest: MH-Z19C (CO2) âœ“**

  **Beschreibung**     UART-Kommunikation und CO2-Messung.

  **Vorbedingung**     MH-Z19C: TXâ†’GPIO16, RXâ†’GPIO15. VCCâ†’5V. StÃ¼tzkondensator
                       220ÂµF (25V) am VCC!

  **Testschritte**     1\. UART 9600 Baud initialisieren 2. 3 Min AufwÃ¤rmzeit
                       3. CO2-Wert bei Frischluft messen

  **Pass-Kriterium**   CO2: 350-600 ppm bei Frischluft. Keine Timeouts.

  **Ergebnis**         â˜‘ PASS â˜ FAIL Datum: Jan 2026 Tester: Team
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
  **TC-05**            **Einzeltest: PMS5003 (Feinstaub) âœ“**

  **Beschreibung**     UART-Kommunikation und PM-Werte.

  **Vorbedingung**     PMS5003: TXâ†’GPIO18, RXâ†’GPIO17. VCCâ†’5V.

  **Testschritte**     1\. UART 9600 Baud 2. Auf Datenframes warten 3.
                       PM2.5-Wert prÃ¼fen

  **Pass-Kriterium**   GÃ¼ltige Frames mit korrekter Checksum. PM2.5: 0-100
                       Âµg/mÂ³.

  **Ergebnis**         â˜‘ PASS â˜ FAIL Datum: Jan 2026 Tester: Team
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
  **TC-06**            **Einzeltest: LD2410C (Radar) âœ“**

  **Beschreibung**     UART + Level Shifter, PrÃ¤senzerkennung.

  **Vorbedingung**     LD2410C Ã¼ber Level Shifter: TXâ†’GPIO6, RXâ†’GPIO7,
                       OUTâ†’GPIO15. StÃ¼tzkondensator 220ÂµF (25V)!

  **Testschritte**     1\. Level Shifter TX-Ausgang messen (MUSS 3.3V sein!)
                       2. UART 256000 Baud 3. PrÃ¤senz bei AnnÃ¤herung testen

  **Pass-Kriterium**   TX-Pegel â‰¤3.3V. OUT-Pin schaltet bei Bewegung.

  **Ergebnis**         â˜‘ PASS â˜ FAIL Datum: Jan 2026 Tester: Team
  -------------------- -------------------------------------------------------

Teil 2: Hardware-Tests

MOSFET-Steuerung und Kondensator-Stabilisierung.

  -------------------- -------------------------------------------------------
  **TC-07**            **Hardware: BS170 MOSFET Backlight-Steuerung**

  **Beschreibung**     Testet die PWM-Dimmung des Display-Backlights Ã¼ber den
                       BS170 MOSFET.

  **Vorbedingung**     BS170 MOSFET: Gateâ†’GPIO21 (Ã¼ber 1kÎ©), Drainâ†’Display
                       BL-, Sourceâ†’GND.

  **Testschritte**     1\. PWM-Kanal auf GPIO21 konfigurieren (5kHz) 2. Duty
                       0% setzen â†’ Display komplett dunkel 3. Duty 50% setzen
                       â†’ halbe Helligkeit 4. Duty 100% setzen â†’ volle
                       Helligkeit 5. Rampe 0â†’100% in 1s (Fade-In Effekt)

  **Pass-Kriterium**   Helligkeit stufenlos regelbar. Kein Flackern. Smooth
                       Fade mÃ¶glich.

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
                       **Hardware: StÃ¼tzkondensatoren StabilitÃ¤t ğŸ”„**

  **Beschreibung**     PrÃ¼ft, ob die 220ÂµF (25V) Kondensatoren am CO2-Sensor
                       und Radar Stromspitzen puffern und AbstÃ¼rze verhindern.

  **Vorbedingung**     220ÂµF (25V) Elkos an VCC/GND von MH-Z19C und LD2410C.
                       Alle Sensoren aktiv.

  **Testschritte**     1\. System OHNE Kondensatoren starten â†’ Absturz
                       provozieren 2. Kondensatoren einlÃ¶ten 3. System 10
                       Minuten laufen lassen 4. Spannung am 5V-Rail mit
                       Oszilloskop/Multimeter beobachten

  **Pass-Kriterium**   MIT Kondensatoren: Keine AbstÃ¼rze, 5V-Rail stabil
                       (4.8-5.2V). OHNE: Dokumentierter Absturz.

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

Teil 3: Integrationstest

  -------------------- -------------------------------------------------------
  **TC-09**            **Integration: Alle Sensoren gleichzeitig ğŸ”„**

  **Beschreibung**     PrÃ¼ft, ob alle 5 Sensoren + Radar parallel
                       funktionieren ohne Konflikte.

  **Vorbedingung**     Alle Sensoren verkabelt. StÃ¼tzkondensatoren
                       installiert. Firmware mit allen Treibern.

  **Testschritte**     1\. System starten 2. Serial-Log auf Init-Meldungen
                       prÃ¼fen (alle \[OK\]) 3. 5 Minuten alle Werte loggen 4.
                       Auf I2C/UART-Fehler oder Timeouts prÃ¼fen

  **Pass-Kriterium**   Alle Sensoren initialisiert. Fehlerrate \<1% Ã¼ber 5
                       Minuten.

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

Teil 4: UI-Tests

Tests fÃ¼r beide User Interfaces und die Umschaltung.

  -------------------- -------------------------------------------------------
  **TC-10**            **UI: Clean-Interface Darstellung**

  **Beschreibung**     Testet das einfache, Ã¼bersichtliche UI mit allen
                       Messwerten.

  **Vorbedingung**     Display und alle Sensoren funktional. Clean-UI
                       implementiert.

  **Testschritte**     1\. System starten (Standard: Clean-UI) 2. Alle 6 Werte
                       prÃ¼fen: CO2, PM2.5, VOC, Temp, Feuchte, PrÃ¤senz 3.
                       Farbcodierung prÃ¼fen (GrÃ¼n/Gelb/Rot je nach Grenzwert)
                       4. Lesbarkeit aus 1m Entfernung

  **Pass-Kriterium**   Alle Werte sichtbar und korrekt. Farben entsprechen
                       Grenzwerten. Gut lesbar.

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
  **TC-11**            **UI: Detailed-Interface Darstellung**

  **Beschreibung**     Testet das detaillierte/futuristische UI mit
                       erweiterten Informationen.

  **Vorbedingung**     Detailed-UI implementiert.

  **Testschritte**     1\. Zu Detailed-UI wechseln 2. Alle Werte + Zusatzinfos
                       prÃ¼fen (z.B. Trends, Graphen) 3. Farbcodierung prÃ¼fen
                       4. Lesbarkeit prÃ¼fen

  **Pass-Kriterium**   Alle Werte korrekt. Zusatzinfos sinnvoll. Design
                       konsistent.

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
  **TC-12**            **UI: Button-Wechsel zwischen UIs**

  **Beschreibung**     Testet den Wechsel zwischen Clean-UI und Detailed-UI
                       per Button.

  **Vorbedingung**     Beide UIs implementiert. Button an GPIO0.

  **Testschritte**     1\. System im Clean-UI starten 2. Button drÃ¼cken â†’
                       Wechsel zu Detailed-UI 3. Erneut drÃ¼cken â†’ zurÃ¼ck zu
                       Clean-UI 4. 10x schnell hintereinander drÃ¼cken
                       (Stresstest)

  **Pass-Kriterium**   Jeder Druck = genau 1 Wechsel. Kein Prellen. Ãœbergang
                       \<300ms. Kein Absturz bei SchnelldrÃ¼cken.

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
  **TC-13**            **UI: Messwerte-Konsistenz beide UIs**

  **Beschreibung**     PrÃ¼ft, ob beide UIs identische Messwerte anzeigen.

  **Vorbedingung**     Beide UIs funktional.

  **Testschritte**     1\. Im Clean-UI alle Werte notieren 2. Sofort zu
                       Detailed-UI wechseln 3. Werte vergleichen 4. 5x
                       wiederholen zu verschiedenen Zeiten

  **Pass-Kriterium**   Werte in beiden UIs identisch (Abweichung \<1% durch
                       Timing).

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

Teil 5: Power Management

Display-Dimming, Aufwecken per Radar und Light Sleep.

  -------------------- -------------------------------------------------------
  **TC-14**            **Power: Display-Dimming nach Timeout**

  **Beschreibung**     Display dimmt automatisch nach konfigurierter Zeit ohne
                       PrÃ¤senz.

  **Vorbedingung**     DIM_TIMEOUT = 60s. Radar aktiv. MOSFET-Steuerung
                       funktional.

  **Testschritte**     1\. PrÃ¤senz auslÃ¶sen (Person vor Sensor) 2.
                       Display-Helligkeit prÃ¼fen (100%) 3. Raum verlassen /
                       keine Bewegung 4. 65 Sekunden warten 5. Helligkeit
                       prÃ¼fen (sollte gedimmt sein \~15%)

  **Pass-Kriterium**   Dimming erfolgt nach 60s Â±5s. Helligkeit sinkt sichtbar
                       auf Dim-Level.

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
  **TC-15**            **Power: Display-Aufwecken per Radar**

  **Beschreibung**     Gedimmtes Display wacht bei PrÃ¤senzerkennung sofort
                       auf.

  **Vorbedingung**     Display im Dim-Modus. Radar aktiv.

  **Testschritte**     1\. Display dimmen lassen (keine Bewegung 60s) 2.
                       Person nÃ¤hert sich dem Sensor (\<2m) 3. Reaktionszeit
                       messen (Stoppuhr) 4. Helligkeit nach Aufwecken prÃ¼fen

  **Pass-Kriterium**   Aufwecken innerhalb 500ms. Helligkeit = 100%.

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

  -------------------- -------------------------------------------------------
  **TC-16**            **Power: ESP32 Light Sleep Modus**

  **Beschreibung**     ESP32 geht nach lÃ¤ngerer InaktivitÃ¤t in Light Sleep und
                       wacht per Radar auf.

  **Vorbedingung**     Light Sleep implementiert. SLEEP_TIMEOUT konfiguriert
                       (z.B. 5 Min ohne PrÃ¤senz).

  **Testschritte**     1\. System normal laufen lassen 2. Keine PrÃ¤senz fÃ¼r
                       SLEEP_TIMEOUT 3. Stromaufnahme messen (sollte \~0,8mA
                       im Light Sleep) 4. PrÃ¤senz auslÃ¶sen 5. Aufwachzeit
                       messen 6. PrÃ¼fen ob alle Sensoren wieder funktionieren

  **Pass-Kriterium**   Light Sleep erreicht (\~0,8mA). Aufwachen \~2ms. Alle
                       Sensoren nach Wake OK.

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

Teil 6: Systemtest

AbschlieÃŸender Test aller Features im Zusammenspiel.

  -------------------- -------------------------------------------------------
  **TC-17**            **System: Komplett-Szenario Alltagsbetrieb**

  **Beschreibung**     Simuliert einen typischen Nutzungstag mit allen
                       Features.

  **Vorbedingung**     Komplett aufgebautes System. Alle Features
                       implementiert.

  **Testschritte**     1\. System einschalten â†’ Clean-UI, volle Helligkeit 2.
                       Werte ablesen (alle plausibel?) 3. Button drÃ¼cken â†’
                       Detailed-UI 4. Raum verlassen â†’ nach 60s dimmt Display
                       5. Raum betreten â†’ Display wacht auf 6. 30 Min laufen
                       lassen 7. Werte erneut prÃ¼fen

  **Pass-Kriterium**   Alle Funktionen arbeiten zusammen. Keine AbstÃ¼rze.
                       Werte konsistent.

  **Ergebnis**         â˜ PASS â˜ FAIL Datum: \_\_\_\_\_\_\_\_ Tester:
                       \_\_\_\_\_\_\_\_
  -------------------- -------------------------------------------------------

Testprotokoll

  -------- ------------------------------- ------------ ----------- -------------
  **ID**   **Testname**                    **Status**   **Datum**   **Tester**

  TC-01    Einzeltest: Display ST7796S     âœ“ PASS       Jan 2026    Team

  TC-02    Einzeltest: AHT20               âœ“ PASS       Jan 2026    Team
           (Temp/Feuchte)                                           

  TC-03    Einzeltest: SGP40 (VOC)         âœ“ PASS       Jan 2026    Team

  TC-04    Einzeltest: MH-Z19C (CO2)       âœ“ PASS       Jan 2026    Team

  TC-05    Einzeltest: PMS5003 (Feinstaub) âœ“ PASS       Jan 2026    Team

  TC-06    Einzeltest: LD2410C (Radar)     âœ“ PASS       Jan 2026    Team

  TC-07    Hardware: BS170 MOSFET          â˜                        
           Backlight-Steuerung                                      

           Hardware: StÃ¼tzkondensatoren    ğŸ”„ IN ARBEIT             
           StabilitÃ¤t ğŸ”„                                            

  TC-09    Integration: Alle Sensoren      ğŸ”„ IN ARBEIT             
           gleichzeitig ğŸ”„                                          

  TC-10    UI: Clean-Interface Darstellung â˜                        

  TC-11    UI: Detailed-Interface          â˜                        
           Darstellung                                              

  TC-12    UI: Button-Wechsel zwischen UIs â˜                        

  TC-13    UI: Messwerte-Konsistenz beide  â˜                        
           UIs                                                      

  TC-14    Power: Display-Dimming nach     â˜                        
           Timeout                                                  

  TC-15    Power: Display-Aufwecken per    â˜                        
           Radar                                                    

  TC-16    Power: ESP32 Light Sleep Modus  â˜                        

  TC-17    System: Komplett-Szenario       â˜                        
           Alltagsbetrieb                                           
  -------- ------------------------------- ------------ ----------- -------------

Zusammenfassung

  ----------------------------------- -----------------------------------
  **Tests bestanden**                 \_\_\_\_ / 17

  **Tests nicht bestanden**           \_\_\_\_ / 17

  **Gesamtergebnis**                  â˜ BESTANDEN â˜ NICHT BESTANDEN
  ----------------------------------- -----------------------------------

**Anmerkungen:**

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

Unterschrift: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ Datum:
\_\_\_\_\_\_\_\_\_\_\_

Anhang A: Grenzwerte

  ----------------- ----------------- ----------------- -----------------
  **Parameter**     **Gut (GrÃ¼n)**    **MÃ¤ÃŸig (Gelb)**  **Schlecht
                                                        (Rot)**

  **CO2**           \< 800 ppm        800-1000 ppm      \> 1500 ppm

  **PM2.5**         \< 12 Âµg/mÂ³       12-35 Âµg/mÂ³       \> 55 Âµg/mÂ³

  **VOC Index**     \< 100            100-150           \> 200
  ----------------- ----------------- ----------------- -----------------

Anhang B: Timeout-Konfiguration

  ----------------------------------- -----------------------------------
  **Parameter**                       **Wert**

  **DIM_TIMEOUT (Display dimmen)**    60 Sekunden ohne PrÃ¤senz

  **SLEEP_TIMEOUT (Light Sleep)**     5 Minuten ohne PrÃ¤senz (optional)

  **DIM_BRIGHTNESS**                  15% (PWM Duty \~38/255)

  **WAKE_BRIGHTNESS**                 100% (PWM Duty 255/255)
  ----------------------------------- -----------------------------------

Anhang C: Kritische Hardware-Hinweise

**âš ï¸ StÃ¼tzkondensatoren (220ÂµF (25V)):** ZWINGEND erforderlich an
VCC/GND von MH-Z19C und LD2410C! Ohne diese stÃ¼rzt das System bei
Stromspitzen ab.

**âš ï¸ Level Shifter (LD2410C):** TX-Ausgang des Radar-Sensors MUSS Ã¼ber
Level Shifter laufen. Direkte 5V-Signale zerstÃ¶ren den ESP32!

**âš ï¸ BS170 MOSFET:** Gate-Widerstand 1kÎ© zwischen GPIO21 und Gate.
Logic-Level MOSFET, schaltet bei 3.3V durch.
